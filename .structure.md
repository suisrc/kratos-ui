# é¡¹ç›®ç»“æ„è¯´æ˜

## é¡¹ç›®åˆå§‹åŒ–

```
// åˆ›å»ºé¡¹ç›®
tyarn create @umijs/umi-app
tyarn
tyarn add @umijs/preset-react

// ä½¿ç”¨UMI UI
// UMI_UI=1 HOST=0.0.0.0 yarn start
tyarn add @umijs/preset-ui -D
// ä¿®æ”¹.umirc.ts
```

## ç›®å½•ç»“æ„
```
.
â”œâ”€â”€ package.json
â”œâ”€â”€ .umirc.ts
â”œâ”€â”€ .env
â”œâ”€â”€ config
â”œâ”€â”€ dist
â”œâ”€â”€ mock
â”œâ”€â”€ public
â””â”€â”€ src
    â”œâ”€â”€ .umi
    â”œâ”€â”€ layouts/index.tsx
    â”œâ”€â”€ components
    â”œâ”€â”€ pages
    |   â”œâ”€â”€ index.less
    |   â””â”€â”€ index.tsx
    â””â”€â”€ app.ts
```
### package.json
åŒ…å«æ’ä»¶å’Œæ’ä»¶é›†

### .env
[env](https://umijs.org/zh-CN/docs/env-variables)  
ç¯å¢ƒå˜é‡ã€‚

### config
[config](https://umijs.org/zh-CN/docs/config)  
Umi åœ¨ .umirc.ts æˆ– config/config.ts ä¸­é…ç½®é¡¹ç›®å’Œæ’ä»¶ï¼Œæ”¯æŒ es6ã€‚  
æ¨èåœ¨ .umirc.ts ä¸­å†™é…ç½®ã€‚å¦‚æœé…ç½®æ¯”è¾ƒå¤æ‚éœ€è¦æ‹†åˆ†ï¼Œå¯ä»¥æ”¾åˆ° config/config.ts ä¸­ï¼Œå¹¶æŠŠé…ç½®çš„ä¸€éƒ¨åˆ†æ‹†å‡ºå»ï¼Œæ¯”å¦‚è·¯ç”±ã€‚  
ä¸¤è€…äºŒé€‰ä¸€ï¼Œ.umirc.ts ä¼˜å…ˆçº§æ›´é«˜ã€‚ 

### dist
æ‰§è¡Œ umi build åï¼Œäº§ç‰©é»˜è®¤ä¼šå­˜æ”¾åœ¨è¿™é‡Œã€‚

### docker
é•œåƒæ„å»ºå’Œä¾èµ–çš„å†…å®¹

### mock
[mock](https://umijs.org/zh-CN/docs/mock)  
Mock æ•°æ®æ˜¯å‰ç«¯å¼€å‘è¿‡ç¨‹ä¸­å¿…ä¸å¯å°‘çš„ä¸€ç¯ï¼Œæ˜¯åˆ†ç¦»å‰åç«¯å¼€å‘çš„å…³é”®é“¾è·¯ã€‚é€šè¿‡é¢„å…ˆè·ŸæœåŠ¡å™¨ç«¯çº¦å®šå¥½çš„æ¥å£ï¼Œæ¨¡æ‹Ÿè¯·æ±‚æ•°æ®ç”šè‡³é€»è¾‘ï¼Œèƒ½å¤Ÿè®©å‰ç«¯å¼€å‘ç‹¬ç«‹è‡ªä¸»ï¼Œä¸ä¼šè¢«æœåŠ¡ç«¯çš„å¼€å‘æ‰€é˜»å¡ã€‚

### public
æ­¤ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶ä¼šè¢« copy åˆ°è¾“å‡ºè·¯å¾„ã€‚

### .umi
ä¸´æ—¶æ–‡ä»¶ç›®å½•ï¼Œæ¯”å¦‚å…¥å£æ–‡ä»¶ã€è·¯ç”±ç­‰ï¼Œéƒ½ä¼šè¢«ä¸´æ—¶ç”Ÿæˆåˆ°è¿™é‡Œã€‚ä¸è¦æäº¤ .umi ç›®å½•åˆ° git ä»“åº“ï¼Œä»–ä»¬ä¼šåœ¨ umi dev å’Œ umi build æ—¶è¢«åˆ é™¤å¹¶é‡æ–°ç”Ÿæˆã€‚

### assets
å­˜å‚¨ä¸€äº›é™æ€æ–‡ä»¶

### components
[ç»„ä»¶](https://ant.design/docs/react/practical-projects-cn)
éšç€åº”ç”¨çš„å‘å±•ï¼Œä½ ä¼šéœ€è¦åœ¨å¤šä¸ªé¡µé¢åˆ†äº« UI å…ƒç´  (æˆ–åœ¨ä¸€ä¸ªé¡µé¢ä½¿ç”¨å¤šæ¬¡)ï¼Œåœ¨ umi é‡Œä½ å¯ä»¥æŠŠè¿™éƒ¨åˆ†æŠ½æˆ component ã€‚

### exceptions
å¼‚å¸¸é¡µé¢

### layouts
åŸºç¡€å¸ƒå±€å’Œçº¦å®šå¼è·¯ç”±
[çº¦å®šå¼è·¯ç”±](https://umijs.org/zh-CN/docs/convention-routing)  
çº¦å®šå¼è·¯ç”±æ—¶çš„å…¨å±€å¸ƒå±€æ–‡ä»¶ã€‚(è¿™é‡Œä½¿ç”¨é…ç½®å¼è·¯ç”±ï¼Œæ²¡æœ‰è¯¥é…ç½®)
å½“å‰æ¶å­æä¾›äº†ä¸€ä¸ªBasicLayout, ç”¨äºåŸºæœ¬çš„éƒ¨ç½², å¯ä»¥é€šè¿‡ä¿®æ”¹config/route.tsæ–‡ä»¶çš„åŸºç¡€componentsè¿›è¡Œä¿®æ”¹

### locales
[å›½é™…åŒ–](https://ant.design/docs/react/i18n-cn)
è¿™é‡Œæ˜¯é¡¹ç›®å›½é™…åŒ–

### models
[æ¨¡å‹](https://umijs.org/zh-CN/plugins/plugin-dva)  
model åˆ†ä¸¤ç±»ï¼Œä¸€æ˜¯å…¨å±€ modelï¼ŒäºŒæ˜¯é¡µé¢ modelã€‚å…¨å±€ model å­˜äº /src/models/ ç›®å½•ï¼Œæ‰€æœ‰é¡µé¢éƒ½å¯å¼•ç”¨ï¼›é¡µé¢ model ä¸èƒ½è¢«å…¶ä»–é¡µé¢æ‰€å¼•ç”¨ã€‚ 
è§„åˆ™å¦‚ä¸‹ï¼š[v2è¯´æ˜](https://v2.umijs.org/zh/guide/with-dva.html)
```
src/models/**/*.js ä¸º global model
src/pages/**/models/**/*.js ä¸º page model
global model å…¨é‡è½½å…¥ï¼Œpage model åœ¨ production æ—¶æŒ‰éœ€è½½å…¥ï¼Œåœ¨ development æ—¶å…¨é‡è½½å…¥
page model ä¸º page js æ‰€åœ¨è·¯å¾„ä¸‹ models/**/*.js çš„æ–‡ä»¶
page model ä¼šå‘ä¸ŠæŸ¥æ‰¾ï¼Œæ¯”å¦‚ page js ä¸º pages/a/b.jsï¼Œä»–çš„ page model ä¸º pages/a/b/models/**/*.js + pages/a/models/**/*.jsï¼Œä¾æ¬¡ç±»æ¨
çº¦å®š model.js ä¸ºå•æ–‡ä»¶ modelï¼Œè§£å†³åªæœ‰ä¸€ä¸ª model æ—¶ä¸éœ€è¦å»º models ç›®å½•çš„é—®é¢˜ï¼Œæœ‰ model.js åˆ™ä¸å»æ‰¾ models/**/*.js 
```

çº¦å®šï¼šğŸ¹
æ‰€æœ‰çš„æŸ¥è¯¢åˆ†ä¸ºï¼š query, post, check ä¸­æ–¹å¼ä¸ºserviceä¸­çš„æ–¹æ³•åçš„å¼€å¤´å­—ç¬¦  
fetch: æŸ¥è¯¢  
put: æ›´æ”¹  
check: ç¡®è®¤    

ç‰¹åˆ«è¯´æ˜:
1.serviceè¡¨è¿°ä¸º query, post, check. modelä¸­çš„è¡¨è¿°ä¸ºfetch, put, is(has, isè¡¨ç¤ºæ˜¯å¦,hasè¡¨ç¤ºæœ‰æ— , æ˜¯isçš„å­é›†), 
2.modelä¸­çš„å¦‚æœä½¿ç”¨useModel, ç›´æ¥ä¿®æ”¹ä½¿ç”¨set, å¦åˆ™ä½¿ç”¨put
3.ä¸€äº›ç‰¹æ®Šçš„å‡½æ•°,ä¸å¿…éµå¾ªç¬¬ä¸€æ¡çº¦æŸ,æ¯”å¦‚:signin, signout, æ‰€è°“çš„ç‰¹æ®Šæ–¹æ³•è§†æƒ…å†µè€Œå®š.

### services
[Service](https://umijs.org/zh-CN/api#service)
è°ƒç”¨ Umiåº•å±‚å‘½ä»¤æˆ–è®¿é—®åç«¯
çº¦å®šï¼šğŸ¹  
æ‰€æœ‰çš„æŸ¥è¯¢åˆ†ä¸ºï¼š query, post, check ä¸­æ–¹å¼ä¸ºserviceä¸­çš„æ–¹æ³•åçš„å¼€å¤´å­—ç¬¦  
query: æŸ¥è¯¢  
post: æ›´æ”¹  
check: ç¡®è®¤  

æˆ‘ä»¬å¯ä»¥åœ¨pageå±‚è‡ªç”±ä½¿ç”¨serviceå’Œmodelä¸­çš„å†…å®¹,æ‰€ä»¥ä¸ºäº†æ›´å¥½çš„åŒºåˆ†ä½¿ç”¨çš„ç½‘ç»œè¯·æ±‚æ¥è‡ªå“ªé‡Œ,æ‰€ä»¥å¯¹æ–¹æ³•åç§°è¿›è¡Œäº†çº¦æŸ.

//
get: æŸ¥è¯¢
post: æäº¤æ–°å»ºå’Œä¿®æ”¹è¯·æ±‚ï¼ˆè¿™é‡Œå…è®¸ä½¿ç”¨postä»£æ›¿put)  
put: åªèƒ½æäº¤å·²çŸ¥èµ„æºçš„ä¿®æ”¹è¯·æ±‚(å¯¹å•å¯¹è±¡æ“ä½œï¼Œå³ä½¿å­å¯¹è±¡æ˜¯æ–°å»ºå¯ä»¥å¯ä»¥)  
deleteï¼šæäº¤åˆ é™¤å·²çŸ¥èµ„æºçš„åˆ é™¤è¯·æ±‚(å¯¹å•å¯¹è±¡ä»¥åŠè¯¥å¯¹è±¡ä¸‹çš„å­å¯¹è±¡æ“ä½œï¼Œå¦‚æœçˆ¶å¯¹è±¡ä¸ä¿®æ”¹ï¼Œå­å¯¹è±¡åˆ é™¤ï¼Œè¯·ä½¿ç”¨put)  

â˜”ç‰¹æ®Šæ–¹æ³•ï¼Œå¦‚signin, signout, oauth2é™¤å¤–  
  
  
[è¯·æ±‚è§„èŒƒ](https://umijs.org/zh-CN/plugins/plugin-request)   
[å¼‚æ­¥è¯·æ±‚](https://hooks.umijs.org/zh-CN/hooks/async)  
ğŸ–æ³¨æ„ï¼šğŸ”’æ‰€æœ‰çš„è¯·æ±‚ï¼Œå¿…é¡»éµå¾ªä¸€ä¸‹ç»™æ˜¯è¿”å›ï¼Œä¸å¯ä»¥æœ‰ç‰¹æ®Š
```
interface ErrorInfoStructure {
  success: boolean; // if request is success
  data?: any; // response data
  errorCode?: string; // code for errorType
  errorMessage?: string; // message display to user 
  showType?: number; // error display typeï¼š 0 silent; 1 message.warn; 2 message.error; 4 notification; 9 page
  traceId?: string; // Convenient for back-end Troubleshooting: unique request ID
  host?: string; // onvenient for backend Troubleshooting: host of current access server
}

export enum ErrorShowType {
  SILENT = 0, // ä¸æç¤ºé”™è¯¯
  WARN_MESSAGE = 1, // è­¦å‘Šä¿¡æ¯æç¤º
  ERROR_MESSAGE = 2, // é”™è¯¯ä¿¡æ¯æç¤º
  NOTIFICATION = 4, // é€šçŸ¥æç¤º
  REDIRECT = 9, // é¡µé¢è·³è½¬
}
```

### utils
utils æ–¹æ³•ï¼Œç»™æ’ä»¶ä½¿ç”¨ï¼Œå’Œæ’ä»¶é‡Œçš„ api.utils æ˜¯åŒä¸€ä¸ªåº•å±‚åº“ã€‚


### pages
æ‰€æœ‰è·¯ç”±ç»„ä»¶å­˜æ”¾åœ¨è¿™é‡Œã€‚

### wrappers
[wrappers](https://umijs.org/docs/routing#wrappers)  
é…ç½®è·¯ç”±çš„é«˜é˜¶ç»„ä»¶å°è£…ã€‚æ¯”å¦‚ï¼Œå¯ä»¥ç”¨äºè·¯ç”±çº§åˆ«çš„æƒé™æ ¡éªŒ  
å½“å‰æ¶å­ä¸»è¦é…åˆconfig/route.tsåœ¨åšè·³è½¬æ€§æƒé™éªŒè¯


### app.ts
è¿è¡Œæ—¶é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥åœ¨è¿™é‡Œæ‰©å±•è¿è¡Œæ—¶çš„èƒ½åŠ›ï¼Œæ¯”å¦‚ä¿®æ”¹è·¯ç”±ã€ä¿®æ”¹ render æ–¹æ³•ç­‰ã€‚


## å…¶ä»–ç»„ä»¶
umi-plugin-antd-theme: åŠ¨æ€ä¸»é¢˜ç¼–è¯‘, è¿™ä¸ªç»„ä»¶ç¼–è¯‘æ¶ˆè´¹æ—¶é—´å¤ªé•¿ï¼Œæ¨èä»[preview.pro.ant.design](https://preview.pro.ant.design/)ç›´æ¥æ‹‰å–ï¼Œç„¶åæ›´æ–°defaultSettings.tsæ–‡ä»¶  
@umijs/preset-ui: åŠ¨æ€å¢åŠ æ¨¡å—çš„UIæ“ä½œé¡µé¢ã€‚  
umi-plugin-setting-drawer: ä¿®æ”¹ä¸»é¢˜,å½“å‰ç³»ç»Ÿæä¾›äº†ç±»ä¼¼çš„ç»„ä»¶å®Œæˆè¯¥åŠŸèƒ½
```
tyarn add umi-plugin-antd-theme -D // ä¸»é¢˜,ä¸æ¨èä½¿ç”¨
tyarn add @umijs/preset-ui -D      // ä¸šåŠ¡å¼€å‘è¿‡ç¨‹ä¸­æ¨èä½¿ç”¨
UMI_UI=1 HOST=0.0.0.0 umi dev
tyarn add umi-plugin-setting-drawer // ä¸»é¢˜é…ç½®,é¡¹ç›®ä¸­å·²ç»å¯¹è¯¥å†…å®¹è¿›è¡Œäº†é‡å†™

# å¸è½½
tyarn remove umi-plugin-antd-theme -D
tyarn remove @umijs/preset-ui -D
```

## é¸£è°¢
å½“å‰æ¶å­åŸºäºant.designçš„umijsç‰ˆ, ä¿®æ”¹äº†å¸ƒå±€å’Œä¸€äº›æƒé™çš„è®¤è¯æ–¹å¼,è·Ÿäººå†³å®š,åŸå§‹æ¶å­éå¸¸å¥½,ä½†æ˜¯åœ¨ä½¿ç”¨ä¸Š,é€šè¿‡é…ç½®ç”Ÿæˆè·¯ç”±å’Œèœå•è¿‡äºç†æƒ³åŒ–.åœ¨è¿™é‡Œæˆ‘ä»…ä»…åšäº†ä¸€äº›å¿…è¦çš„ä¿®æ”¹,æä¾›ä¸€ä¸ªå¯ä»¥ç›´æ¥ä½¿ç”¨çš„åŸºç¡€æ¶å­,åŒæ—¶æ‰€æœ‰å¼€å‘çš„å†…å®¹,åœ¨å¯ä»¥é€šè¿‡umi-uiç»§ç»­å¼€å‘.    
[Reactjs.cn](https://reactjs.org.cn/doc/hello-world.html)  
[TypeScript](https://www.tslang.cn/docs/home.html)  
[Reactjs.org](https://reactjs.org/docs/react-api.html)  
  
[umijs](umijs.org)  
[ant.design](https://ant.design)  
[pro.ant.design](https://pro.ant.design/docs/getting-started)  
[preview.pro.ant.design](https://preview.pro.ant.design/)  
  
[i18n](https://pro.ant.design/docs/i18n-cn)  
[request](https://hooks.umijs.org/zh-CN/hooks/async)  


